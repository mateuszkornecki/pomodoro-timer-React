(window.webpackJsonptimeboxing=window.webpackJsonptimeboxing||[]).push([[0],{100:function(e,t,n){e.exports=n(209)},105:function(e,t,n){},110:function(e,t){},112:function(e,t){},152:function(e,t){},153:function(e,t){},209:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(99),c=n.n(o),s=(n(105),n(12)),i=n(13),l=n(18),u=n(14),m=n(19),p=n(52),g=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){var t=n.props.onLoginAttempt;e.preventDefault(),t({email:n.loginForm.current.children.emailInput.value,password:n.loginForm.current.children.passwordInput.value}),n.loginForm.current.children.emailInput.value="",n.loginForm.current.children.passwordInput.value=""},n.loginForm=r.a.createRef(),n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("form",{ref:this.loginForm,onSubmit:this.handleSubmit,className:"LoginForm"},this.props.errorMessage?r.a.createElement("div",{className:"LoginForm__error-message"},this.props.errorMessage):"",r.a.createElement("label",{htmlFor:"emailInputt"},"Email: "),r.a.createElement("input",{id:"emailInput",type:"email"}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"passwordInput"},"Password: "),r.a.createElement("input",{id:"passwordInput",type:"password"}),r.a.createElement("br",null),r.a.createElement("button",null,"Zaloguj"))}}]),t}(r.a.Component),h=n(26),d=n.n(h),f=n(50),v={login:function(){var e=Object(f.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("".concat("http://localhost:5000","/login"),"POST",t);case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};function b(e,t,n){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(d.a.mark((function e(t,n,a){var r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a?JSON.stringify(a):void 0,e.next=3,fetch(t,{method:n,headers:{"Content-Type":"application/json"},body:r});case 3:if((o=e.sent).ok){e.next=6;break}throw new Error("Something went wrong!...");case 6:return e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var E=n(55),L=n.n(E),w=n(51),T=r.a.lazy((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,244))})),O=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={accessToken:null,previousLoginAttemptFailed:!1},n.setTimerOnLogIn=function(){var e=Date.now()+36e5;n.interval=setInterval((function(){var t=Date.now();e-t<=0&&n.handleLogout()}),6e4)},n.clearTimeOnLogOut=function(){clearInterval(n.interval)},n.getUserEmail=function(){return L.a.decode(n.state.accessToken).email},n.handleLogout=function(){n.setState({accessToken:null,previousLoginAttemptFailed:!1}),n.removeAccessTokenFromLocalStorage()},n.handleLoginAttempt=function(e){v.login(e).then((function(e){var t=e.accessToken;n.setState({accessToken:t,previousLoginAttemptFailed:!1})})).catch((function(){n.setState({previousLoginAttemptFailed:!0})}))},n.setAccessTokenToLocalStorage=function(){if(n.state.accessToken){localStorage.setItem("timeboxing-access-token",n.state.accessToken);localStorage.getItem("timeboxing-access-token")}},n.getAccessTokenFromLocalStorage=function(){var e=localStorage.getItem("timeboxing-access-token");e&&n.setState({accessToken:e})},n.removeAccessTokenFromLocalStorage=function(){localStorage.removeItem("timeboxing-access-token")},n.isUserLoggedIn=function(){return n.setAccessTokenToLocalStorage(),n.state.accessToken?n.setTimerOnLogIn():n.clearTimeOnLogOut(),!!n.state.accessToken},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getAccessTokenFromLocalStorage()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(p.a,{message:"wyst\u0105pi\u0142 b\u0142\u0105d ca\u0142ej aplikacji"},this.isUserLoggedIn()?r.a.createElement(a.Suspense,{fallback:r.a.createElement("div",null,"Loading...")},r.a.createElement(w.a.Provider,{value:{accessToken:this.state.accessToken,onLogout:this.handleLogout}},r.a.createElement(T,null))):r.a.createElement(g,{errorMessage:this.state.previousLoginAttemptFailed?"Nie uda\u0142o si\u0119 zalogowa\u0107!":null,onLoginAttempt:this.handleLoginAttempt})))}}]),t}(r.a.Component);c.a.render(r.a.createElement(O,null),document.querySelector(".root"))},51:function(e,t,n){"use strict";var a=n(2),r=n.n(a).a.createContext({accessToken:null,onLogout:null});t.a=r},52:function(e,t,n){"use strict";var a=n(12),r=n(13),o=n(18),c=n(14),s=n(19),i=n(2),l=n.n(i),u=n(54),m=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={hasError:!1},n}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidCatch",value:function(e,t){console.log("%c wyst\u0105pi\u0142 nast\u0119puj\u0105cy b\u0142\u0105d","color: red",e,t)}},{key:"render",value:function(){var e=this.props,t=e.message,n=e.children;return l.a.createElement(u.a,{hasError:this.state.hasError,message:t},n)}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(l.a.Component);t.a=m},54:function(e,t,n){"use strict";var a=n(2),r=n.n(a);t.a=function(e){var t=e.message,n=e.children,a=e.hasError;return r.a.createElement("div",null,a?r.a.createElement("div",{className:"ErrorMessage"},t):n)}}},[[100,1,2]]]);
//# sourceMappingURL=main.b0616130.chunk.js.map